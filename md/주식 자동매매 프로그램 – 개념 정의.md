# 주식 자동매매 프로그램 – 개념 정의

기능 명세서를 작성하기 전에, **주식 자동매매 프로그램**에서 공통으로 사용되는 핵심 개념(용어)을 먼저 정의한다.  
이 정의는 이후 요구사항, 기능 명세, 화면/테이블 설계의 기준이 된다.

---

## 1. 시스템 범위와 운영 모드

### 자동매매 시스템 (ATS, Automated Trading System)
시장 데이터 수집 → 매매 판단 → 주문 실행 → 사후 관리(정산·리스크·로그)까지 자동으로 수행하는 소프트웨어.

### 운영 모드
- **백테스트 (Backtest)**  
  과거 데이터를 이용해 전략 성능을 시뮬레이션
- **페이퍼 트레이딩 (Paper / Simulation)**  
  실시간 데이터 기반, 주문은 가상 체결
- **실거래 (Live Trading)**  
  증권사 API를 통해 실제 주문 및 체결

---

## 2. 계정 / 자산 / 시장 단위

### 계좌 (Account)
증권사에 개설된 실제 매매 단위  
(현금계좌, 신용계좌, ISA 등)

### 자산 (Asset / Instrument)
거래 대상 금융상품
- 주식
- ETF / ETN 등

### 시장 (Market / Venue)
거래가 이루어지는 장소 및 규칙 집합
- KOSPI / KOSDAQ
- 거래시간, 호가단위, 서킷브레이커 등 포함

---

## 3. 데이터 (입력)

### 시세 데이터 (Market Data)
- **틱(Tick)**: 체결 단위 데이터
- **바(Bar / Candle)**: 분봉·일봉 등 집계 데이터 (OHLCV)
- **호가(Order Book)**: 매수·매도 잔량과 가격 레벨

### 정적 데이터 (Static Data)
- 종목명
- 상장/거래정지 여부
- 호가단위
- 액면가 정보

### 기업행위 (Corporate Actions)
- 액면분할/병합
- 배당
- 권리락  
※ 백테스트 및 지표 계산에 큰 영향

---

## 4. 전략과 신호 (판단 로직)

### 전략 (Strategy)
매수·매도 규칙의 집합  
예) 이동평균 돌파, 모멘텀, 리밸런싱 전략

### 신호 (Signal)
특정 시점에 전략이 내리는 행동 제안
- Buy / Sell / Hold
- 목표 비중 변경

### 조건 (Condition / Rule)
신호 생성을 위한 개별 규칙

### 지표 (Indicator / Feature)
입력 데이터를 가공해 계산한 값  
예) MA, RSI, VWAP

---

## 5. 포지션 / 포트폴리오 (상태)

### 포지션 (Position)
종목별 보유 상태
- 수량
- 평균단가
- 평가손익

### 포트폴리오 (Portfolio)
전체 자산 구성
- 여러 포지션
- 현금
- 증거금

### 손익 (PnL)
- **실현손익 (Realized PnL)**: 매도 후 확정 손익
- **미실현손익 (Unrealized PnL)**: 평가 손익

### 노출 (Exposure)
특정 종목/섹터/시장에 대한 투자 비중

---

## 6. 주문과 체결 (실행 영역)

### 주문 (Order)
증권사로 전달되는 매매 요청

### 주문 유형
- 지정가 (Limit)
- 시장가 (Market)
- 조건부 주문

### 주문 상태 (Order State)
- 신규
- 접수
- 체결 (부분/전량)
- 정정 / 취소
- 완료 / 거부

### 체결 (Execution / Fill)
실제 거래 결과
- 체결가
- 체결 수량

### 슬리피지 (Slippage)
예상 가격과 실제 체결 가격 간 차이

### 거래비용 (Transaction Costs)
- 수수료
- 세금
- 스프레드 비용

---

## 7. 리스크 관리 (안전장치)

### 리스크 한도 (Risk Limits)
- 종목당 최대 매수 금액/비중
- 하루 최대 손실 한도
- 최대 주문 빈도
- 최대 미체결 주문 수

### 손절 / 익절 (Stop Loss / Take Profit)
손실 또는 이익 기준으로 포지션을 축소하거나 청산

### 거래중단 대응
- 거래정지
- 변동성 완화장치(VI)
- 서킷브레이커

---

## 8. 아키텍처 구성 요소

### 데이터 수집기 (Data Collector)
시장 데이터를 수집·저장·전달

### 전략 엔진 (Strategy Engine)
데이터 → 지표 계산 → 신호 생성

### 리스크 엔진 (Risk Engine)
신호·주문을 리스크 규칙으로 검증 및 차단

### 주문 관리 시스템 (OMS)
- 주문 생성
- 상태 추적
- 정정/취소 관리

### 실행 관리 시스템 (EMS)
- 실제 주문 전송
- 체결 처리
- 재전송 및 오류 대응  
※ 단순 시스템에서는 OMS와 통합되기도 함

### 브로커 커넥터 (Broker API Adapter)
증권사 API 연동 계층

### 저장소 (Storage)
- 시세 데이터
- 주문/체결 데이터
- 로그 및 지표 데이터

### 모니터링 / 알림
- 장애 감지
- 주문 거부
- 손실 한도 초과 알림

---

## 9. 운영 / 품질 / 보안

### 감사 로그 (Audit Log)
주문 및 의사결정 이력 추적

### 멱등성 (Idempotency)
재시작·재처리 시 중복 주문 방지

### 장애 대응 (Recovery / Failover)
- 프로세스 다운
- 네트워크 오류
- API 지연 시 안전 중지 및 복구

### 비밀 정보 관리 (Secrets Management)
- API 키
- 계좌 정보
- 인증 정보 보호