# 주식 자동매매 시스템 – 주요 기능 식별

본 문서는 **KIS(OpenAPI) 기반 주식 자동매매 시스템**의 주요 기능을  
업무 책임 기준으로 식별한 결과를 정리한다.

---

## 주요 기능 개요

> 본 시스템의 주요 기능은 **총 8개 영역**으로 구분된다.  
> 각 영역은 단일 책임(SRP)을 가지며, 독립적인 개발·테스트·운영이 가능하도록 설계된다.

---

## 1. 인증 · 계좌 · 권한 관리  
**(Account & Authentication Management)**

### 목적
- 증권사(KIS) API 접근을 위한 인증
- 거래 계좌 및 권한의 안전한 관리

### 주요 기능
- KIS OpenAPI 인증 토큰 관리 (access_token)
- WebSocket 승인키(approval_key) 발급
- Hashkey 발급 및 관리
- 실전 / 모의투자 계좌 분리
- 계좌 활성 / 비활성 관리
- 계좌별 매수 가능 금액, 보유 수량 조회

---

## 2. 시장 데이터 관리  
**(Market Data Management)**

### 목적
- 전략 판단에 필요한 정확한 시장 데이터 제공

### 주요 기능
- 실시간 체결가 수신 (WebSocket)
- 실시간 호가 수신
- 분봉 / 일봉 데이터 생성
- 거래정지, 관리종목, VI 상태 반영
- 기업행위(액면분할, 배당 등) 데이터 관리

---

## 3. 전략 관리  
**(Strategy Management)**

### 목적
- 매매 판단 로직을 구조적으로 정의하고 관리

### 주요 기능
- 전략 등록 및 수정
- 전략 버전 관리
- 전략 파라미터 관리
- 전략 활성 / 비활성 제어
- 전략 실행 주기 관리 (1분봉, 일봉, 장마감 등)

---

## 4. 신호 생성  
**(Signal Generation)**

### 목적
- 전략 결과를 실제 행동 가능한 신호로 변환

### 주요 기능
- 기술 지표 계산 (MA, RSI 등)
- 매수 / 매도 / 보유(Hold) 신호 생성
- 목표 수량 또는 목표 비중 산출
- 신호 발생 시각 및 유효기간(TTL) 관리

---

## 5. 리스크 관리  
**(Risk Management)**

### 목적
- 자동매매로 인한 손실 및 시스템 사고 방지

### 주요 기능
- 종목별 / 계좌별 투자 한도 설정
- 1일 최대 손실 제한
- 주문 빈도 및 미체결 주문 제한
- 거래정지 종목 차단
- Kill Switch(강제 거래 중단) 기능

---

## 6. 주문 관리 및 실행  
**(Order & Execution Management, OMS / EMS)**

### 목적
- 전략 신호를 실제 증권사 주문으로 안전하게 실행

### 주요 기능
- 주문 생성 (시장가, 지정가, IOC, FOK 등)
- 주문 입력 검증 및 호가단위 보정
- 주문 상태 관리 (접수, 체결, 취소 등)
- 주문 정정 / 취소
- KIS OpenAPI 연동
- 멱등성 처리(중복 주문 방지)

---

## 7. 체결 · 포지션 · 손익 관리  
**(Execution, Position & PnL Management)**

### 목적
- 체결 결과를 정확히 반영하여 자산 상태를 관리

### 주요 기능
- 실시간 체결 처리
- 부분 체결 누적 처리
- 포지션 수량 및 평균단가 갱신
- 실현 손익 / 미실현 손익 계산
- 포트폴리오 스냅샷 생성

---

## 8. 운영 · 모니터링 · 백테스트  
**(Operations, Monitoring & Backtesting)**

### 목적
- 시스템의 안정적 운영과 전략 성능 검증

### 주요 기능
- 실시간 시스템 상태 모니터링
- 주문 실패, 손실 한도 초과 알림
- 감사 로그(Audit Log) 관리
- 장애 감지 및 복구
- 백테스트 실행
- 전략 성과 분석 및 리포트 생성

---

## 기능 흐름 요약

```text
[1 인증/계좌]
        ↓
[2 시장데이터]
        ↓
[3 전략관리]
        ↓
[4 신호생성]
        ↓
[5 리스크관리]
        ↓
[6 주문/실행]
        ↓
[7 체결/손익]
        ↓
[8 운영/백테스트]
